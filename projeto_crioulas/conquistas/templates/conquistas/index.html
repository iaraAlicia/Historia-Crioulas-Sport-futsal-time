{% load static %}
<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>Conquistas - Crioulas FC</title>
    <link href="https://fonts.googleapis.com/css2?family=Antonio:wght@700&family=Oswald:wght@300;400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{% static 'css/style_conquistas.css' %}">
</head>
<body>

    <div class="bg-image" id="bg-image" 
        style="{% if conquistas %}background-image: url('{{ conquistas.last.imagem.url }}');{% endif %}">
    </div>
    <div class="overlay-dark"></div>

    <nav class="top-nav">
        <a href="/">HOME</a>
        <a href="{% url 'historia:index' %}">HISTÓRIA</a>
        <a href="#" class="active">CONQUISTAS</a>
        <a href="/galeria/">GALERIA</a>
    </nav>

    <div class="main-container">
        
        <div class="wheel-wrapper">
            <div class="curved-line"></div>
            
            <div class="wheel-list" id="wheel-list">
                {% for item in conquistas %}
                    <div class="wheel-item" 
                         onclick="selectYear({{ forloop.counter0 }})"
                         data-index="{{ forloop.counter0 }}"
                         data-titulo="{{ item.titulo }}"
                         data-desc="{{ item.descricao }}"
                         data-img="{% static 'img/' %}{{ item.imagem }}">
                        {{ item.ano }}
                    </div>
                {% endfor %}
            </div>
            
            <div class="controls">
                <button onclick="move(-1)">▲</button>
                <button onclick="move(1)">▼</button>
            </div>
        </div>

        <div class="content-display">
            <h3 class="category-tag">#TRAJETÓRIA</h3>
            <h1 id="display-title" class="main-title">...</h1>
            <p id="display-desc" class="description">...</p>
            <div class="stats-box">CONCEIÇÃO DAS CRIOULAS</div>
        </div>
    </div>

    <script>
        let currentIndex = 0;
        const items = document.querySelectorAll('.wheel-item');
        const totalItems = items.length;

        // Inicializa com o último ano selecionado (ou o primeiro)
        // Se quiser começar no último (2024), mude para: totalItems - 1
        selectYear(totalItems - 1); 

        function selectYear(index) {
            currentIndex = index;
            updateWheel();
        }

        function move(direction) {
            let newIndex = currentIndex + direction;
            if (newIndex >= 0 && newIndex < totalItems) {
                selectYear(newIndex);
            }
        }

        function updateWheel() {
            const titleEl = document.getElementById('display-title');
            const descEl = document.getElementById('display-desc');
            const bgEl = document.getElementById('bg-image');

            items.forEach((item, i) => {
                // Calcula a distância do item para o centro (ativo)
                const distance = i - currentIndex;

                // Reseta classes
                item.className = 'wheel-item';

                // Aplica classes baseadas na distância (Curva Lógica)
                if (distance === 0) {
                    item.classList.add('active');
                    
                    // Atualiza texto e imagem
                    titleEl.innerText = item.getAttribute('data-titulo');
                    descEl.innerText = item.getAttribute('data-desc');
                    bgEl.style.backgroundImage = `url('${item.getAttribute('data-img')}')`;
                    
                } else if (distance === -1) {
                    item.classList.add('prev-1');
                } else if (distance === -2) {
                    item.classList.add('prev-2');
                } else if (distance === 1) {
                    item.classList.add('next-1');
                } else if (distance === 2) {
                    item.classList.add('next-2');
                } else {
                    item.classList.add('hidden'); // Esconde os que estão muito longe
                }
            });
        }
    </script>
</body>
</html>